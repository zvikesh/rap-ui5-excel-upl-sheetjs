<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:l="sap.ui.layout"
    xmlns:core="sap.ui.core"
    xmlns:u="sap.ui.unified"
    xmlns:upload="sap.m.upload"
>
    <Dialog
        id="idDialogExcelUpload"
        title="Excel Upload"
    >
        <content>
            <upload:UploadSet
                id="idFileUploaderSet"
                fileTypes="xlsx, xls"
                maxFileNameLength="200"
                multiple="false"
                mode="None"
                terminationEnabled="true"
                items="{ path: '/', templateShareable: false }"
                beforeUploadStarts="onBeforeUploadStarts"
                uploadCompleted="onUploadCompleted"
                afterItemRemoved="onAfterItemRemoved"
            >
                <upload:UploadSetItem
                    id="idFileUploaderItems"
                    enabledEdit="false"
                    visibleEdit="false"
                    visibleRemove="true"
                    fileName="{name}"
                    url="/upload"
                >
                    <upload:attributes>
                        <ObjectAttribute
                            id="_IDGenObjectAttribute1"
                            title="Uploaded by"
                            text="{user}"
                            active="false"
                        />
                    </upload:attributes>
                </upload:UploadSetItem>
            </upload:UploadSet>
        </content>

        <buttons>
            <Button
                id="idDownloadTemplateButton"
                text="Download"
                press="onDownloadTemplate"
                icon="sap-icon://download-from-cloud"
                type="Emphasized"
            />
            <Button
                id="idUploadExcelButton"
                text="Upload"
                press="onUploadSet"
                icon="sap-icon://upload-to-cloud"
                type="Emphasized"
            />
            <Button
                id="idCancelButton"
                press="onCloseDialog"
                text="Cancel"
                icon="sap-icon://cancel"
            />
        </buttons>

        <endButton>
            <Button
                id="_IDGenButton4"
                press=".onCloseDialog"
                text="Ok"
            />
        </endButton>
    </Dialog>
</core:FragmentDefinition>
